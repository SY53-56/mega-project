import{e as y,u as S,g as A,c as F,r as i,a as b,h as N,i as h,j as e,L as v,B as u,k as U,l as z,m as H,n as M,o as q}from"./index-CnFdDQzR.js";import{H as G}from"./heart-CHAS5O9B.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],W=y("arrow-left",J);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],K=y("arrow-right",Y);function T(){const l=S(),{id:a}=A(),k=F(),[_,d]=i.useState(0),[x,g]=i.useState(""),{currentBlog:t,status:C,error:p,review:f}=b(s=>s.blog),{user:n}=b(s=>s.auth),o=t?.author?._id,r=t?.image?.length||0;let m=n?.id||n?._id;const I=n?.following?.includes(o),j=t?.like?.map(s=>s)?.includes(n?._id),L=()=>{if(!n)return alert("Please login");if(m===o)return alert("You cannot follow yourself");l(U(o))};i.useEffect(()=>{a&&(l(N(a)),l(h(a)))},[a,l]),i.useEffect(()=>{if(r<=1)return;const s=setInterval(()=>{d(c=>c===r-1?0:c+1)},4e3);return()=>clearInterval(s)},[r]);const B=i.useCallback(()=>{d(s=>s===r-1?0:s+1)},[r]),D=i.useCallback(()=>{d(s=>s===0?r-1:s-1)},[r]),R=()=>{l(z(a)).unwrap().then(()=>k("/"))},P=s=>{s.preventDefault(),x.trim()&&l(H({blogId:a,reviewData:{comment:x}})).unwrap().then(()=>{g(""),l(h(a))})},$=(s,c)=>{n?._id===c&&l(M(s)).unwrap().then(()=>l(h(a)))};function E(){if(!n)return alert("Please login to like this blog");l(q(t?._id)).unwrap().then(()=>l(N(t._id)))}const w=m===o;return console.log("isauthor",w),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-100 via-white to-pink-100 py-10 px-4",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-center mb-10 text-gray-800",children:"Blog Details"}),C==="loading"&&e.jsx("p",{className:"text-center",children:"Loading..."}),p&&e.jsx("p",{className:"text-center text-red-500",children:p}),t&&e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t?.image?.[_],alt:"blog",className:"w-full h-[260px] lg:h-[520px] object-cover"}),r>1&&e.jsxs(e.Fragment,{children:[e.jsx(W,{onClick:D,className:"absolute top-1/2 left-4 w-9 h-9 p-2 bg-black/50 text-white rounded-full cursor-pointer"}),e.jsx(K,{onClick:B,className:"absolute top-1/2 right-4 w-9 h-9 p-2 bg-black/50 text-white rounded-full cursor-pointer"})]})]}),e.jsxs("div",{className:"p-8 flex-col",children:[e.jsxs("div",{className:"w-full  items-center justify-between lg:flex gap-8 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(v,{to:`/user/${o}/blogs`,children:e.jsx("img",{src:t.author?.image||"https://wallpaperaccess.com/full/8669676.jpg",className:" w-16 lg:w-20 h-12 rounded-full object-cover"})}),e.jsxs("div",{className:" w-full",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Author"}),e.jsx("h3",{className:"font-semibold text-lg",children:t.author?.username})]})]}),e.jsxs("div",{className:"flex gap-16 mt-8",children:[e.jsxs("div",{className:"flex  justify-center gap-2 items-center",children:[e.jsx("button",{onClick:E,className:`flex items-center cursor-pointer gap-1 px-3 py-1 rounded-full ${j?"bg-red-200":"bg-gray-100"}`,children:e.jsx(G,{size:18,className:`transition ${j?"text-red-500 full-red-500":"text-gray-500"}`})}),e.jsx("span",{children:t.like?.length||0})]}),e.jsx(u,{onClick:L,className:"bg-blue-600 text-white px-4 py-1 rounded-lg",name:I?"Unfollow":"Follow"})]})]}),e.jsx("h2",{className:"text-3xl font-bold",children:t.title}),e.jsx("p",{className:"mt-4 text-gray-700",children:t.description}),w&&e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(u,{to:`/userUpdate/${a}`,className:"bg-blue-500 text-white",name:"EditBlog"}),e.jsx(u,{onClick:R,className:"bg-red-600 text-white",name:"Delete"})]})]})]}),e.jsxs("div",{className:"bg-white mt-10 p-6 rounded-2xl shadow-lg",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Comments (",f.length,")"]}),e.jsxs("form",{onSubmit:P,className:"flex gap-3",children:[e.jsx("input",{value:x,onChange:s=>g(s.target.value),className:"flex-1 border rounded-lg px-4 py-2",placeholder:"Write your comment..."}),e.jsx("button",{className:"bg-indigo-500 hover:bg-indigo-600  text-white px-5 cursor-pointer rounded-md transition-all duration-500",children:"Post"})]}),e.jsx("div",{className:"mt-6 space-y-4",children:f.map(s=>e.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm hover:shadow-md transition",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{to:`/user/${s.user._id}/blogs`,children:e.jsx("img",{src:s?.user?.image,alt:"user",className:"w-11 h-11 rounded-full object-cover cursor-pointer"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:s.user.username}),e.jsx("p",{className:"text-xs text-gray-400",children:"Just now"})]})]}),m===s?.user?._id&&e.jsx("button",{onClick:()=>$(s._id),className:"text-xs bg-red-100 text-red-600 hover:bg-red-200 px-3 py-1 rounded-full transition",children:"Delete"})]}),e.jsx("div",{className:"mt-3 ml-14",children:e.jsx("p",{className:"text-gray-700 leading-relaxed",children:s.comment})})]},s._id))})]})]})})}export{T as default};
